# Forensics

## File analysis

File format

```sh
file <file_name>
hd <file_name>
```

Tools:
+ [HxD](https://mh-nexus.de/en/hxd/)
+ [Magic bytes](https://en.wikipedia.org/wiki/List_of_file_signatures)
+ [Hex editor online](https://hexed.it/)

Readable content

```sh
strings <file_name>
grep "something" <file_name>
bgrep
```

## Image analysis

Metadata

```sh
exiftool <file_name>
```

Extract gif

```sh
ffmpeg -i file.gif -vsync 0 output/file%d.png
```

Tools:
+ [Online Exiftool](https://exif.tools/)
+ [Google Image](https://images.google.com/)

## Stegography

```sh
steghide extract -sf <file_name>
stegcracker <file_name> /usr/share/wordlists/rockyou.txt
zsteg <file_name>
```

Tools:
+ [Aperisolve](https://www.aperisolve.com/)

## Network analysis

```sh
# over analysis
tshark -z io,phs -r <file_name>
# export object
tshark -r <file_name> --export-objects "http,object" -2
```

Tools:
+ [Wireshark](https://www.wireshark.org/)
+ [NetworkMiner](https://www.netresec.com/?page=NetworkMiner)
+ [PCAP Repair](https://f00l.de/hacking/pcapfix.php)

## Office file

Extract VBA macro

```sh
olevba <file_name>
```

Extract PDF images

```sh
pdfimages -all <file_name> img
```

## Audio file

Tools:
+ [Audacity](https://www.audacityteam.org/)
+ [Sonic Visualizer](https://www.sonicvisualiser.org/)
+ [Deepsound](https://github.com/oneplus-x/DeepSound-2.0)
+ [SilentEye](https://github.com/achorein/silenteye)

## File System analysis

binary image analysis

```sh
binwalk <file_name>
binwalk -e <file_name>
bulk_extractor -o <file_name>
```

Tools:
+ [FTK Imager](https://www.exterro.com/ftk-imager)
+ [AutoPsy](https://www.autopsy.com/)

## Windows event analysis

Tools:
+ [RegRipper](https://github.com/keydet89/RegRipper3.0)
+ [DeepBlueCLI](https://github.com/sans-blue-team/DeepBlueCLI)
+ [APT-Hunter](https://github.com/ahmedkhlief/APT-Hunter)

## Memory dump analysis

```sh
# overview os image
volatility -f <file_name> imageinfo
# check process list
volatility -f <file_name> --profile=PROFILE pslist
# last directory shellbag
volatility -f <file_name> --profile=PROFILE shellbags
# scan network
volatility -f <file_name> --profile=PROFILE netscan
# scan hidden processes
volatility -f <file_name> --profile=PROFILE psxview
# scan malicious process
volatility -f <file_name> --profile=PROFILE ldrmodules
# view DLL unexpected patches
volatility -f <file_name> --profile=PROFILE apihooks
# check environmental variable of process
volatility -f <file_name> --profile=PROFILE envars --pid=584
# find malware code
volatility -f <file_name> --profile=PROFILE malfind
# dump malware code of process to folder
volatility -f <file_name> --profile=PROFILE memdump --pid=584 -D .
# list DLL in memory
volatility -f <file_name> --profile=PROFILE dlllist
# dump DLL of process to folder
volatility -f <file_name> --profile=PROFILE dlldump --pid=584 -D .
```
